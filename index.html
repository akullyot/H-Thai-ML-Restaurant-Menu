<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H-Thai-ML: Home</title>
    <link rel="stylesheet" href="style.css" type="text/css">
</head>
<body>
    <div id="main-terminal-window">
    <header>
        <div id="top-navbar-logo">
            <span id="logo-span"> &gt;<em>H-Thai-ML</em></span>
            <span id="terminal-underscore"> _ </span>
        </div>
        <nav>
            <ul class="navbar-list">
                <li class="navbar"> <a> HOME </a></li>
                <li class="navbar"> <a> MENU </a></li>
                <li class="navbar"> <a> ABOUT </a></li>
                <li class="navbar"> <a> CONTACT </a></li>
            </ul>
        </nav>
    </header>
    <div id = "welcome-carousel">
        <img src = "images\satay-chicken-3604856_1920_huahom.jpg" alt = "satay-chicken-by-huahom">
    </div>
    </div>
<script>
    //function to create terminal writing animation
    function blink() 
    {
        var blinker = document.getElementById('terminal-underscore');
        setInterval(function() 
        {
        blinker.style.display = (blinker.style.display == 'none' ? '' : 'none');
        }, 1000);
    }

    var i = 0;
    var txt = 'H-Thai-ML';
    var speed = 10;
function typeWriter() {
  if (i < txt.length) {
    document.getElementById("logo-span").innerHTML += txt.charAt(i);
    i++;
    setTimeout(typeWriter, speed);
  }
}
    //function that converts lat and lon to radians and compare the two to find the closest location in K units
    function distance(lat0, lon0, lat1, lon1) 
    {
        var radlat0 = Math.PI * lat0/180;
        var radlat1 = Math.PI * lat1/180;
        var theta = lon0-lon1;
        var radtheta = Math.PI * theta/180;
        var dist = Math.sin(radlat0) * Math.sin(radlat1) + Math.cos(radlat0) * Math.cos(radlat1) * Math.cos(radtheta);
        if (dist > 1) 
        {
            dist = 1;
        }
        dist = Math.acos(dist);
        dist = dist * 180/Math.PI;
        dist = dist * 60 * 1.1515;
        dist = dist * 1.609344; //converting to K units
    return dist;
}
    //function that takes users location and shows the closest location in the logo span
    function displayCorrectLocation()
    {
        const options = 
        {
        enableHighAccuracy: true,
        timeout: 5000,
        maximumAge: 0,
        };
        function success(pos) 
        {
            const storeLocations = 
            {
            "Houston"    : {latitude: 29.7604267, longitude: -95.3698028} ,
            "Seattle"    : {latitude: 47.6062095, longitude: -122.3320708},
            "Tampa"      : {latitude: 27.964157, longitude: -82.452606},
            "Wilmington" : {latitude: 34.225727, longitude: -77.944710},
            }
            const usersCrd = pos.coords;
            console.log("Your current position is:");
            console.log(`Latitude : ${usersCrd.latitude}`);
            console.log(`Longitude: ${usersCrd.longitude}`);
            // convert lat and long to radians
            var distances = {};
            let closestCity = "Houston"
            for (let i=0; i < Object.keys(storeLocations).length; i++)
            {
                var radialDistance = distance(usersCrd.latitude, usersCrd.longitude,storeLocations[Object.keys(storeLocations)[i]].latitude , storeLocations[Object.keys(storeLocations)[i]].longitude);
                distances[Object.keys(storeLocations)[i]] = radialDistance;
                if (i > 0)
                {
                    let distLast = distances[Object.keys(storeLocations)[i-1]];
                    let distCurrent = radialDistance;
                    console.log(distLast, distCurrent);
                    if (distCurrent > distLast)
                    {
                        closestCity = Object.keys(storeLocations)[i];
                    }
                    else if (distCurrent == distLast)
                    {
                        //very unlikely to happen but lets just give it the current one 
                        closestCity = Object.keys(storeLocations)[i];
                    }
                }
            }
            document.getElementById("logo-location").innerHTML = closestCity;
        }
        function error(err) 
        {
            console.warn(`ERROR(${err.code}): ${err.message}`);
            //just put them in the deafult location which I have decided is Houston
            alert("Location unknown, showing our Houston Site");
            document.getElementById("logo-location").innerHTML = "Houston";
        }
        navigator.geolocation.getCurrentPosition(success, error, options);
    }
    
    
    //displayCorrectLocation();
    blink();




</script>
</body>
</html>